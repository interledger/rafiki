import { LinkOut } from '@interledger/docs-design-system'

### Required

<div class="overflow-table wider-column">

| Variable                        | Helm value name                                                                 | Default                                                     | Description                                                                                                           |
| ------------------------------- | ------------------------------------------------------------------------------- | ----------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------- |
| `AUTH_SERVER_GRANT_URL`         | `config.backend.auth.grantUrl`                                                  | _undefined_                                                 | The endpoint on your Open Payments authorization server to grant a request.                                           |
| `AUTH_SERVER_INTROSPECTION_URL` | `config.backend.auth.introspectionUrl`                                          | _undefined_                                                 | The endpoint on your Open Payments authorization server to introspect an access token.                                |
| `DATABASE_URL`                  | `config.backend.databaseUrl.value` or `config.backend.databaseUrl.secretKeyRef` | `postgresql://postgres:password@localhost:5432/development` | The Postgres database URL of the database storing your resource data. Can be provided as a value or secret reference. |
| `EXCHANGE_RATES_URL`            | `config.backend.rates.url`                                                      | _undefined_                                                 | The endpoint your Rafiki instance uses to request exchange rates.                                                     |
| `ILP_ADDRESS`                   | `config.backend.ilp.address`                                                    | _undefined_                                                 | The ILP address of your Rafiki instance.                                                                              |
| `ILP_CONNECTOR_URL`             | `config.backend.ilp.connector`                                                  | _undefined_                                                 | The ILP connector address where ILP packets are received.                                                             |
| `KEY_ID`                        | `config.backend.key.id`                                                         | _undefined_                                                 | Your Rafiki instance's client key ID.                                                                                 |
| `OPEN_PAYMENTS_URL`             | `config.backend.ilp.host`                                                       | _undefined_                                                 | The public endpoint of your Open Payments resource server.                                                            |
| `REDIS_URL`                     | `config.backend.redisUrl.value` or `config.backend.redisUrl.secretKeyRef`       | `redis://127.0.0.1:6379`                                    | The Redis URL of the database handling ILP packet data. Can be provided as a value or secret reference.               |
| `USE_TIGERBEETLE`               | `config.backend.useTigerbeetle`                                                 | `false`                                                     | When `true`, a TigerBeetle database is used for accounting. When `false`, a Postgres database is used.                |
| `WEBHOOK_URL`                   | `config.backend.webhook.url`                                                    | _undefined_                                                 | Your endpoint that consumes webhook events.                                                                           |

</div>

### Conditionally required

<div class="overflow-table">

| Variable        | Helm value name               | Default     | Description                                                                                                                                                               |
| --------------- | ----------------------------- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `INSTANCE_NAME` | `config.backend.instanceName` | _undefined_ | Your Rafiki instance's name used to communicate for auto-peering and/or [telemetry](/overview/concepts/telemetry). Required when auto-peering and/or telemetry is enabled |
| `TRUST_PROXY`   | `config.backend.trustProxy`   | `false`     | Must be set to `true` when running Rafiki behind a proxy. When `true`, the `X-Forwarded-Proto` header is used to determine if connections are secure.                     |

</div>

### Optional

<div class="overflow-table wider-column">

| Variable                                              | Helm value name                                                                                       | Default                                                                     | Description                                                                                                                                                                                                                                 |
| ----------------------------------------------------- | ----------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `ADMIN_PORT`                                          | `config.backend.port.admin`                                                                           | `3001`                                                                      | The port of your Backend Auth API server.                                                                                                                                                                                                   |
| `ADMIN_API_SIGNATURE_TTL_SECONDS`                     | _undefined_                                                                                           | `30`                                                                        | The time to live (TTL), in seconds, for which a request's signature will be valid.                                                                                                                                                          |
| `API_SECRET`                                          | _undefined_                                                                                           | _undefined_                                                                 | N/A                                                                                                                                                                                                                                         |
| `API_SIGNATURE_VERSION`                               | _undefined_                                                                                           | `1`                                                                         | The version of the request signing algorithm used to generate signatures.                                                                                                                                                                   |
| `AUTO_PEERING_SERVER_PORT`                            | `config.backend.port.autoPeering`                                                                     | `3005`                                                                      | If auto-peering is enabled, the server will use this port.                                                                                                                                                                                  |
| `CONNECTOR_PORT`                                      | `config.backend.port.connector`                                                                       | `3002`                                                                      | The port of the ILP connector for sending packets via ILP over HTTP.                                                                                                                                                                        |
| `ENABLE_AUTO_PEERING`                                 | `config.backend.autoPeering.enabled`                                                                  | `false`                                                                     | When `true`, auto-peering is enabled.                                                                                                                                                                                                       |
| `ENABLE_MANUAL_MIGRATIONS`                            | _undefined_                                                                                           | `false`                                                                     | When `true`, you must run the database manually with the command `npm run knex – migrate:latest –env production`                                                                                                                            |
| `ENABLE_SPSP_PAYMENT_POINTERS`                        | _undefined_                                                                                           | `true`                                                                      | When `true`, the SPSP route is enabled.                                                                                                                                                                                                     |
| `ENABLE_TELEMETRY`                                    | `config.backend.telemetry.enabled`                                                                    | `false`                                                                     | Enables the telemetry service on Rafiki.                                                                                                                                                                                                    |
| `ENABLE_TELEMETRY_TRACES`                             | _undefined_                                                                                           | `false`                                                                     | N/A                                                                                                                                                                                                                                         |
| `EXCHANGE_RATES_LIFETIME`                             | _undefined_                                                                                           | `15000`                                                                     | The time, in milliseconds, the exchange rates you provide via the `EXCHANGE_RATES_URL` are valid.                                                                                                                                           |
| `GRAPHQL_IDEMPOTENCY_KEY_LOCK_MS`                     | _undefined_                                                                                           | `2000`                                                                      | The time to live (TTL), in milliseconds, for `idempotencyKey` concurrency lock on GraphQL mutations on the Backend Admin API.                                                                                                               |
| `GRAPHQL_IDEMPOTENCY_KEY_TTL_MS`                      | _undefined_                                                                                           | `86400000` (24 hours)                                                       | The time to live (TTL), in milliseconds, for `idempotencyKey` on GraphQL mutations on the Backend Admin API.                                                                                                                                |
| `INCOMING_PAYMENT_CREATED_POLL_FREQUENCY_MS`          | _undefined_                                                                                           | `1000`                                                                      | N/A                                                                                                                                                                                                                                         |
| `INCOMING_PAYMENT_CREATED_POLL_TIMEOUT_MS`            | _undefined_                                                                                           | `10000`                                                                     | N/A                                                                                                                                                                                                                                         |
| `INCOMING_PAYMENT_EXPIRY_MAX_MS`                      | _undefined_                                                                                           | `2592000000` (30 days)                                                      | The maximum into the future, in milliseconds, incoming payments expiry can be set to on creation.                                                                                                                                           |
| `INCOMING_PAYMENT_WORKER_IDLE`                        | _undefined_                                                                                           | `200`                                                                       | The time, in milliseconds, that `INCOMING_PAYMENT_WORKERS` will wait until checking an empty incoming payment request queue again.                                                                                                          |
| `INCOMING_PAYMENT_WORKERS`                            | _undefined_                                                                                           | `1`                                                                         | The number of workers processing incoming payment requests.                                                                                                                                                                                 |
| `LOG_LEVEL`                                           | `config.backend.logLevel`                                                                             | `info`                                                                      | <LinkOut href="https://getpino.io/#/docs/api?id=levels">Pino log level</LinkOut>                                                                                                                                                            |
| `MAX_OUTGOING_PAYMENT_RETRY_ATTEMPTS`                 | _undefined_                                                                                           | `5`                                                                         | Specifies how many times an outgoing payment is retried before failing completely.                                                                                                                                                          |
| `NODE_ENV`                                            | `config.backend.nodeEnv`                                                                              | `development`                                                               | The type of node environment: `development`, `test`, or `production`.                                                                                                                                                                       |
| `OPEN_PAYMENTS_PORT`                                  | `config.backend.port.openPayments`                                                                    | `3000`                                                                      | The port of your Open Payments resource server.                                                                                                                                                                                             |
| `OPEN_TELEMETRY_COLLECTOR_URLS`                       | _undefined_                                                                                           | \*undefined                                                                 | N/A                                                                                                                                                                                                                                         |
| `OPEN_TELEMETRY_EXPORT_INTERVAL`                      | _undefined_                                                                                           | `15000`                                                                     | N/A                                                                                                                                                                                                                                         |
| `OPEN_TELEMETRY_TRACE_COLLECTOR_URLS`                 | _undefined_                                                                                           | _undefined_                                                                 | N/A                                                                                                                                                                                                                                         |
| `OUTGOING_PAYMENT_WORKER_IDLE`                        | _undefined_                                                                                           | `10`                                                                        | The time, in milliseconds, that `OUTGOING_PAYMENT_WORKERS` wait until they check an empty outgoing payment request queue again.                                                                                                             |
| `OUTGOING_PAYMENT_WORKERS`                            | _undefined_                                                                                           | `1`                                                                         | The number of workers processing outgoing payment requests.                                                                                                                                                                                 |
| `POLL_INCOMING_PAYMENT_CREATED_WEBHOOK`               | _undefined_                                                                                           | `false`                                                                     | N/A                                                                                                                                                                                                                                         |
| `QUOTE_LIFESPAN`                                      | _undefined_                                                                                           | `300000` (5 minutes)                                                        | The time, in milliseconds, an Open Payments quote is valid for.                                                                                                                                                                             |
| `REDIS_TLS_CA_FILE_PATH`                              | _undefined_                                                                                           | `''`                                                                        | <LinkOut href="https://redis.io/docs/latest/operate/oss_and_stack/management/security/encryption/">Redis TLS config</LinkOut>                                                                                                               |
| `REDIS_TLS_CERT_FILE_PATH`                            | _undefined_                                                                                           | `''`                                                                        | <LinkOut href="https://redis.io/docs/latest/operate/oss_and_stack/management/security/encryption/">Redis TLS config</LinkOut>                                                                                                               |
| `REDIS_TLS_KEY_FILE_PATH`                             | _undefined_                                                                                           | `''`                                                                        | <LinkOut href="https://redis.io/docs/latest/operate/oss_and_stack/management/security/encryption/">Redis TLS config</LinkOut>                                                                                                               |
| `SIGNATURE_SECRET`                                    | `config.backend.webhookSignatureSecret.value` or `config.backend.webhookSignatureSecret.secretKeyRef` | _undefined_                                                                 | The secret to generate request header signatures for webhook event requests.                                                                                                                                                                |
| `SIGNATURE_VERSION`                                   | _undefined_                                                                                           | `1`                                                                         | The version number to generate request header signatures for webhook events.                                                                                                                                                                |
| `SLIPPAGE`                                            | `config.backend.slippage`                                                                             | `0.01` (1%)                                                                 | The accepted ILP rate fluctuation.                                                                                                                                                                                                          |
| `TELEMETRY_EXCHANGE_RATES_LIFETIME`                   | _undefined_                                                                                           | `86400000` (24 hours)                                                       | Lifetime for telemetry exchange rates in milliseconds.                                                                                                                                                                                      |
| `TELEMETRY_EXCHANGE_RATES_URL`                        | _undefined_                                                                                           | `https://telemetry-exchange-rates.s3.amazonaws.com/exchange-rates-usd.json` | The endpoint Rafiki will query for exchange rates. Used as a fallback if/when [exchange rates](/integration/requirements/exchange-rates) aren’t provided.                                                                                   |
| `TIGERBEETLE_CLUSTER_ID`                              | _undefined_                                                                                           | `0`                                                                         | The TigerBeetle cluster ID picked by the system that starts the TigerBeetle cluster to create a <LinkOut href="https://docs.tigerbeetle.com/clients/node/#creating-a-client">TigerBeetle client</LinkOut>.                                  |
| `TIGERBEETLE_REPLICA_ADDRESSES`                       | _undefined_                                                                                           | `3004`                                                                      | TigerBeetle replica addresses for all replicas in the cluster. The addresses are comma-separated IP addresses/ports, to create a <LinkOut href="https://docs.tigerbeetle.com/clients/node/#creating-a-client">TigerBeetle client</LinkOut>. |
| `TIGERBEETLE_TWO_PHASE_TIMEOUT_SECONDS`               | _undefined_                                                                                           | `5`                                                                         | Two-phase timeout for TigerBeetle in seconds.                                                                                                                                                                                               |
| `WALLET_ADDRESS_DEACTIVATION_PAYMENT_GRACE_PERIOD_MS` | _undefined_                                                                                           | `86400000` (24 hours)                                                       | The time into the future, in milliseconds, to set expiration of Open Payments incoming payments when deactivating a wallet address.                                                                                                         |
| `WALLET_ADDRESS_LOOKUP_TIMEOUT_MS`                    | _undefined_                                                                                           | `1500`                                                                      | The time, in milliseconds, you have to create a missing wallet address before timeout.                                                                                                                                                      |
| `WALLET_ADDRESS_POLLING_FREQUENCY_MS`                 | _undefined_                                                                                           | `100`                                                                       | The frequency of polling while waiting for you to create a missing wallet address.                                                                                                                                                          |
| `WALLET_ADDRESS_REDIRECT_HTML_PAGE`                   | `config.backend.walletAddressRedirectHtmlPage`                                                        | _undefined_                                                                 | Custom HTML page for wallet address redirects.                                                                                                                                                                                              |
| `WALLET_ADDRESS_URL`                                  | `config.backend.ilp.host`                                                                             | `http://127.0.0.1:3001/.well-known/pay`                                     | Your Rafiki instance's internal wallet address.                                                                                                                                                                                             |
| `WALLET_ADDRESS_WORKER_IDLE`                          | _undefined_                                                                                           | `200`                                                                       | The time, in milliseconds, that `WALLET_ADDRESS_WORKERS` wait until checking the empty wallet address request queue again.                                                                                                                  |
| `WALLET_ADDRESS_WORKERS`                              | _undefined_                                                                                           | `1`                                                                         | The number of workers processing wallet address requests.                                                                                                                                                                                   |
| `WEBHOOK_MAX_RETRY`                                   | _undefined_                                                                                           | `10`                                                                        | The maximum number of times your Rafiki instance's backend retries sending a certain webhook event to your configured `WEBHOOK_URL`.                                                                                                        |
| `WEBHOOK_TIMEOUT`                                     | `config.backend.webhook.timeout`                                                                      | `2000` (2 seconds)                                                          | The time, in milliseconds, that your Rafiki instance will wait for a `200` response from your webhook endpoint. If a `200` response isn't received, Rafiki will time out and try to send the webhook event again.                           |
| `WEBHOOK_WORKER_IDLE`                                 | _undefined_                                                                                           | `200`                                                                       | The time, in milliseconds, that `WEBHOOK_WORKERS` will wait until they check the empty webhook event queue again.                                                                                                                           |
| `WEBHOOK_WORKERS`                                     | _undefined_                                                                                           | `1`                                                                         | The number of workers processing webhook events.                                                                                                                                                                                            |
| `WITHDRAWAL_THROTTLE_DELAY`                           | `config.backend.withdrawalThrottleDelay`                                                              | _undefined_                                                                 | The delay in liquidity withdrawal processing, in milliseconds.                                                                                                                                                                              |
| `LIVENET`                                             | `config.backend.telemetry.livenet`                                                                    | `false`                                                                     | When `true`, enables livenet mode for production deployments.                                                                                                                                                                               |

</div>
